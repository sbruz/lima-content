# PRD: Lima Content Generation & Publishing

## üéØ –¶–µ–ª—å
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ, –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è **Lima: Daily I Am Affirmations**. –ü–∞–π–ø–ª–∞–π–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø—É—Ç—å –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–æ –∏—Ç–æ–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–º—Ç–æ–≤ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

---

## üß© –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Supabase ‚Üê‚Üí Python Pipeline ‚Üê‚Üí ChatGPT (LLM) ‚Üê‚Üí ElevenLabs ‚Üê‚Üí S3 CDN
```
1. **Supabase** ‚Äî —Ö—Ä–∞–Ω–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç—Ä–µ–Ω–µ—Ä–æ–≤) –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–∏, —Å—Ü–µ–Ω–∞—Ä–∏–∏, –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º—Ç—ã).
2. **Python-–ø–∞–π–ø–ª–∞–π–Ω** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç —à–∞–≥–∞–º–∏, –ø–æ—Ç–æ–∫–∞–º–∏, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Ä–µ—Ç—Ä–∞—è–º–∏ –∏ —ç–∫—Å–ø–æ—Ä—Ç–æ–º.
3. **ChatGPT (LLM)** ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏, –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–∏, —Å—Ü–µ–Ω–∞—Ä–∏–∏, –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º—Ç—ã –∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –º–µ—Ç–∫–∏/–ø—Ä–µ–≤—å—é.
4. **ElevenLabs** ‚Äî –æ–∑–≤—É—á–∫–∞ –ø–æ –≥–æ—Ç–æ–≤—ã–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º (TTS).
5. **S3 CDN** ‚Äî –∫–æ–Ω–µ—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞.

---

## üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
/lima-content
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ config.yaml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ /src
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ runtime/
‚îÇ   ‚îú‚îÄ‚îÄ steps/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step1_localize_categories.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step2_localize_subcategories.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step3_fill_views.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step4_generate_affirmations.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step5_script_affirmations.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step6_generate_audio.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ step7_music_prompts.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ noop_step.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ /docs
‚îÇ   ‚îú‚îÄ‚îÄ readme.md
‚îÇ   ‚îú‚îÄ‚îÄ intro.txt
‚îÇ   ‚îú‚îÄ‚îÄ intro_coaches.txt
‚îÇ   ‚îú‚îÄ‚îÄ prd_content.md
‚îÇ   ‚îú‚îÄ‚îÄ /agents/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ category.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ subcategory.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ affirmations_base.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ affirmations_script_translate.md
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ affirmations_script_pauses.md
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ affirmations_music.md
‚îÇ   ‚îî‚îÄ‚îÄ /steps/
‚îÇ       ‚îú‚îÄ‚îÄ 00_multithreading.md
‚îÇ       ‚îú‚îÄ‚îÄ 01_localize_categories.md
‚îÇ       ‚îú‚îÄ‚îÄ 02_localize_subcategories.md
‚îÇ       ‚îú‚îÄ‚îÄ 03_fill_views.md
‚îÇ       ‚îú‚îÄ‚îÄ 04_generate_affirmations.md
‚îÇ       ‚îú‚îÄ‚îÄ 05_script_affirmations.md
‚îÇ       ‚îú‚îÄ‚îÄ 06_generate_audio.md
‚îÇ       ‚îú‚îÄ‚îÄ 07_music_prompts.md
‚îÇ       ‚îú‚îÄ‚îÄ 08_compose_music.md
‚îÇ       ‚îú‚îÄ‚îÄ 09_make_affirmations.md
‚îÇ       ‚îî‚îÄ‚îÄ 10_daily_affirmations.md
‚îú‚îÄ‚îÄ /logs
‚îî‚îÄ‚îÄ /export
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`config.yaml`)

```yaml
steps:
  localize_categories: true
  localize_subcategories: true
  fill_views: true
  generate_affirmations: true
  script_affirmations: true
  music_prompts: true
  generate_audio: false
  compose_music: false
  make_affirmations: false
  daily_affirmations: false

range:
  categories: [1, -1]
  subcategories: [1, -1]
  positions: [1, -1]

languages: [ru, en]
versions: [Roxie, Goddard]
voices: [1, 2, 3]
affirmations_per_subcategory: 10
threads: 4
threads_audio: 10
threads_music: 5

retry:
  attempts: 3
  delays_sec: [5, 10]

rate_limits:
  openai:
    calls_per_minute: 60
    burst: 5

logging:
  level: INFO
  file: ./logs/last_run.log

views:
  base_min: 500
  base_max: 2000
  seed: 2026

audio_mix:
  music_volume_db: 0
  music_fade_in_ms: 0
  music_fade_out_ms: 0

ids:
  namespace: lima-content
```

---

## üóÉÔ∏è –ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö (Supabase)

### –¢–∞–±–ª–∏—Ü–∞ `categories`
- `id:int/uuid`
- `name:string` ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- `localization:json` ‚Äî –ø–µ—Ä–µ–≤–æ–¥—ã –≤–∏–¥–∞ `{"ru": "...", "en": "..."}`.
- `position:int` ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä.

### –¢–∞–±–ª–∏—Ü–∞ `subcategories`
- `id:int/uuid`
- `category_id` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ `categories`.
- `name:string` ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- `localization:json` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è: `{"female":{"title":{"ru":"...","en":"..."}}, "male":{...}}`.
- `position:int` ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- `shadow_w:string` ‚Äî —Ü–≤–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –∂–µ–Ω—â–∏–Ω.
- `shadow_m:string` ‚Äî —Ü–≤–µ—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –º—É–∂—á–∏–Ω.
- `views:int` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤.
- `ready:string|null` ‚Äî —Å—Ç–∞—Ç—É—Å —à–∞–≥–∞ 2 (`READY`, `CHECK`, `NULL`).

### –¢–∞–±–ª–∏—Ü–∞ `coaches`
- `id:int/uuid`
- `coach:string` ‚Äî –∫–æ–¥ –∏–ª–∏ –∏–º—è —Ç—Ä–µ–Ω–µ—Ä–∞ (`Roxie`, `Goddard` –∏ —Ç.–¥.).
- `prompt:text` ‚Äî —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π —Å—Ç–∏–ª—å —Ç—Ä–µ–Ω–µ—Ä–∞.

### –¢–∞–±–ª–∏—Ü–∞ `affirmations`
- `id:int/uuid`
- `subcategory_id` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ `subcategories`.
- `coach_id` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ `coaches`.
- `position:int` ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä (1‚Ä¶`affirmations_per_subcategory`).
- `affirmation:json` ‚Äî –±–∞–∑–æ–≤—ã–µ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–∏ –∏ —Å—Ü–µ–Ω—ã:
  ```
  {
    "female": {"affirmation": "...", "scene": "..."},
    "male":   {"affirmation": "...", "scene": "..."}
  }
  ```
- `script:json|null` ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ –ø–æ–ª—É –∏ —è–∑—ã–∫–∞–º:
  ```
  {
    "female": {"ru": {"title": "...", "script": "..."}, "en": {...}},
    "male":   {"ru": {...}, "en": {...}}
  }
  ```
- `music:json|null` ‚Äî –º—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º—Ç—ã:
  `{"female": "...", "male": "..."}`.
- `duration:json|null` ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–∑–≤—É—á–µ–∫ –ø–æ –∏–º–µ–Ω–∞–º —Ñ–∞–π–ª–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä `{"1_2_3_m_en_ts1710000000.mp3": 42.3}`.

### –¢–∞–±–ª–∏—Ü–∞ `voices`
- `voice_key:string`
- `voice_name:string`
- `name:json` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –∏–º–µ–Ω–∞ –Ω–∞ —è–∑—ã–∫–∞—Ö.
- `sex:string` ‚Äî `M` / `F`.
- `description:json`

> **Pydantic:** –∫–∞–∂–¥—ã–π —à–∞–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ Pydantic-–º–æ–¥–µ–ª–∏. –ó–∞–ø—Ä–µ—â–µ–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥—Ä—É–≥–∏—Ö —à–∞–≥–æ–≤ –∏–ª–∏ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ö ‚Äî —Ç–∞–∫ –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

---

## üß† –®–∞–≥–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞

0. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** ‚Äî —Å–º. `/docs/steps/00_multithreading.md`.

1. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π**  
   –ü—Ä–æ–º–ø—Ç: `/docs/agents/category.md`  
   –ü–µ—Ä–µ–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ —Ü–µ–ª–µ–≤—ã–µ —è–∑—ã–∫–∏ –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º `categories.localization`.

2. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π**  
   –ü—Ä–æ–º–ø—Ç: `/docs/agents/subcategory.md`  
   –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π, —É –∫–æ—Ç–æ—Ä—ã—Ö `ready != "READY"`. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã—Å—Ç–∞–≤–ª—è–µ–º `ready = "CHECK"`.

3. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ views**  
   –°–º. `/docs/steps/03_fill_views.md`. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Å–µ–≤–¥–æ—Å–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã –≤ —Ä–∞–º–∫–∞—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π**  
   –ü—Ä–æ–º–ø—Ç: `/docs/agents/affirmations_base.md`  
   - –§–ª–∞–≥: `steps.generate_affirmations`.  
   - –í—ã–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º –∏ —Ç—Ä–µ–Ω–µ—Ä–æ–≤ –∏–∑ `coaches`, —á—å–∏ `coach` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ `config.versions`.  
   - –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è √ó —Ç—Ä–µ–Ω–µ—Ä) –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ LLM: –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –ø—Ä–æ–º–ø—Ç —Ç—Ä–µ–Ω–µ—Ä–∞ –∏ —Ü–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ `affirmations_per_subcategory`.  
   - –ü–æ–ª—É—á–∞–µ–º –ø–æ `N` –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π –¥–ª—è –∂–µ–Ω—â–∏–Ω –∏ –º—É–∂—á–∏–Ω, —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ `affirmations` (—Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ √ó —Ç—Ä–µ–Ω–µ—Ä–∞ —É–¥–∞–ª—è–µ–º).

5. **–°—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π**  
   –ü—Ä–æ–º–ø—Ç—ã: `/docs/agents/affirmations_script_translate.md` –∏ `/docs/agents/affirmations_script_pauses.md`  
   - –§–ª–∞–≥: `steps.script_affirmations`.  
   - –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç—Ä–µ–Ω–µ—Ä–∞ –∏ –ø–æ–∑–∏—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ–º —Ü–∏–∫–ª –ø–æ —è–∑—ã–∫–∞–º.  
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º –¥–≤–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–∞ LLM (–ø–µ—Ä–µ–≤–æ–¥ –∏ –ø–∞—É–∑—ã). –®–∞–≥ –ø–∞—É–∑ –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ `config.script_affirmations_add_pauses`.
     1. **–ü–µ—Ä–µ–≤–æ–¥ (TRNS)** ‚Äî –±–µ—Ä—ë–º `affirmations.affirmation`, `coaches.prompt`, `target_language`. –î–ª—è EN —ç—Ç–æ—Ç —à–∞–≥ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª.
     2. **–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—É–∑ (PAUS)** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ (–ª–∏–±–æ –∏—Å—Ö–æ–¥–Ω–∏–∫ –¥–ª—è EN) –∏ –ø—Ä–æ—Å–∏–º LLM —Ä–∞—Å—Å—Ç–∞–≤–∏—Ç—å `\n`.  
   - –û–±–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ JSON `{"affirmation":{"female":{"title","script"},"male":{"title","script"}}}`.  
   - –†–µ–∑—É–ª—å—Ç–∞—Ç PAUS —Å–≤–æ–¥–∏–º –≤ –æ–±—â–∏–π –æ–±—ä–µ–∫—Ç `{"female": {lang: {...}}, "male": {lang: {...}}}` –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ `affirmations.script` (–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω—É–ª—è–µ–º). –ü–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∑–∞–º–µ–Ω—è–µ–º –≤—Å–µ –∫–∞–≤—ã—á–∫–∏ –≤ `script` –Ω–∞ –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã, —É–¥–∞–ª—è–µ–º —ç–∫—Ä–∞–Ω–∏—Ä—É—é—â–∏–µ —Å–ª–µ—à–∏ –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º JSON –≤ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ.  
   - –í –∫–æ–Ω—Å–æ–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–∑—ã–∫–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è TRNS –∏ PAUS —Å –ø—Ä–æ–≥—Ä–µ—Å—Å‚Äë–±–∞—Ä–æ–º –∏ ETA.

6. **–û–∑–≤—É—á–∫–∞ ElevenLabs** ‚Äî —Å–º. `/docs/steps/06_generate_audio.md`  
   - –§–ª–∞–≥: `steps.generate_audio`.  
   - –î–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è √ó –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è √ó —Ç—Ä–µ–Ω–µ—Ä √ó –ø–æ–∑–∏—Ü–∏—è √ó —è–∑—ã–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç–¥–µ–ª—å–Ω—É—é –∑–∞–¥–∞—á—É.  
   - –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (`affirmations.script`) –∏ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ SDK ElevenLabs (`model_id=eleven_v3`, `language_code` –≤ ISO 639‚Äë1, `stability=0.5`).  
   - –ì–æ–ª–æ—Å –±–µ—Ä—ë–º –∏–∑ `coaches.voice_EL_ID`, –∞—É–¥–∏–æ –∏ json —Å —Ç–∞–π–º–∏–Ω–≥–∞–º–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ `./export/audio` –≤ —Ñ–æ—Ä–º–∞—Ç–µ `<cat_pos>_<sub_pos>_<pos>_<m|w>_<lang>_ts<unix>.{mp3,json}` (—Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è).  
   - –ü–æ–ª–µ `affirmations.duration` —Ö—Ä–∞–Ω–∏—Ç —Å–ª–æ–≤–∞—Ä—å `{filename: seconds}`; –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –ø–æ–∑–∏—Ü–∏—é –æ—á–∏—â–∞–µ–º –∏ –∑–∞—Ç–µ–º –¥–æ–ø–∏—Å—ã–≤–∞–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

7. **–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º—Ç—ã** ‚Äî —Å–º. `/docs/steps/07_music_prompts.md`  
   –ü—Ä–æ–º–ø—Ç: `/docs/agents/affirmations_music.md`  
   - –§–ª–∞–≥: `steps.music_prompts`.  
   - –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç—Ä–µ–Ω–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–µ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏.  
   - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —É LLM —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –º—É–∑—ã–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è (–ø–æ –ø–æ–ª—É).  
   - –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ `affirmations.music` (–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—è –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è).

8. **–°–≤–µ–¥–µ–Ω–∏–µ –º—É–∑—ã–∫–∏** ‚Äî —Å–º. `/docs/steps/08_compose_music.md`  
   - –§–ª–∞–≥: `steps.compose_music`.  
   - –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ `affirmations` –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª –ø–æ –ø–æ–ª—É –∏ —è–∑—ã–∫–∞–º.  
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–æ–º—Ç—ã –∏–∑ —à–∞–≥–∞ 7 –≤ ElevenLabs Music API, –ø–æ–ª—É—á–∞–µ–º –∞—É–¥–∏–æ—Ñ–æ–Ω.  
   - –ú–∏–∫—Å—É–µ–º —Ñ–æ–Ω —Å –∏—Ç–æ–≥–æ–≤—ã–º –≥–æ–ª–æ—Å–æ–º (—É—á–∏—Ç—ã–≤–∞—è `audio_mix`), –æ–±–Ω–æ–≤–ª—è–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ `*_final.mp3`.

---

## üßæ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Ä–µ—Ç—Ä–∞–∏

- **–ö–æ–Ω—Å–æ–ª—å** ‚Äî —Ç–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è:
  - —Å—Ç–∞—Ä—Ç –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —à–∞–≥–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∑–∞–¥–∞—á –∏ –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º;
  - —Å—Ç–∞—Ä—Ç –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å—É—â–Ω–æ—Å—Ç–∏ (–∫–∞—Ç–µ–≥–æ—Ä–∏—è/–ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è/—Ç—Ä–µ–Ω–µ—Ä) —Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é;
  - –∏—Ç–æ–≥–∏ –ø–æ —à–∞–≥—É: –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –ø—Ä–æ–ø—É—â–µ–Ω–æ, –æ—à–∏–±–æ–∫, –æ–±—â–µ–µ –≤—Ä–µ–º—è.
- **–§–∞–π–ª `./logs/last_run.log`** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-–ª–æ–≥:
  - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã —à–∞–≥–∞, –ø–æ—Ç–æ–∫–∞, –∑–∞–¥–∞—á–∏, correlation id;
  - payload –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (OpenAI, ElevenLabs) —Å –æ–±–µ–∑–ª–∏—á–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏;
  - —Ä–µ—Ç—Ä–∞–∏ (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫, –∑–∞–¥–µ—Ä–∂–∫–∏ 5s/10s);
  - –ø—Ä–æ–≥—Ä–µ—Å—Å (—Å–∫–æ—Ä–æ—Å—Ç—å, ETA, —Å—á—ë—Ç—á–∏–∫–∏);
  - —Å—Ç–µ–∫—Ç—Ä–µ–π—Å—ã –æ—à–∏–±–æ–∫.
- **–û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤**: –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –ø—Ä–µ–∂–Ω–∏–µ —Ñ–∞–π–ª—ã `last_run.log*` —É–¥–∞–ª—è—é—Ç—Å—è.
- **JSON-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –≤ –ë–î –ø—Ä–∏–≤–æ–¥–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫ —á–∏—Ç–∞–µ–º–æ–º—É –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –≤–∏–¥—É (sorted keys).

---

## üîê –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å –∏ —Å–µ–∫—Ä–µ—Ç—ã
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ `.env`: `SUPABASE_URL`, `SUPABASE_KEY`, `OPENAI_API_KEY`, `ELEVENLABS_API_KEY`, `S3_*`.
- `.env` –Ω–µ –∫–æ–º–º–∏—Ç–∏–º; –µ—Å—Ç—å `.env.example`.
- –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç PII –∏ –ø–æ–ª–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ –∫–ª—é—á–µ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).

---

## üö¶ –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º (–∫–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏).
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è —Ç—Ä–µ–π—Å–∏–Ω–≥–∞.
- –û—Ç—á—ë—Ç –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á –∏ —à–∞–≥–∞.
- –ü–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∏–¥—ã —Ö—Ä–∞–Ω–∏–º –≤ –∫–æ–Ω—Ñ–∏–≥–µ).

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/prd_content.md` ‚Äî —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç.
- `docs/readme.md` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –∑–∞–ø—É—Å–∫—É.
- `docs/steps/*.md` ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –Ω—é–∞–Ω—Å—ã –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞.
- `docs/agents/*.md` ‚Äî –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è LLM.
