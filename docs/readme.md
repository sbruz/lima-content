# Lima Content Pipeline

## üîç –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è **Lima: Daily I Am Affirmations** ‚Äî –æ—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ –¥–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–∑–≤—É—á–∫–∏ —á–µ—Ä–µ–∑ ElevenLabs.

---

## üß∞ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:
```env
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-service-key
OPENAI_API_KEY=sk-...
ELEVENLABS_API_KEY=...
S3_ACCESS_KEY=...
S3_SECRET_KEY=...
S3_BUCKET=lima-content
```

### 4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–§–∞–π–ª `config.yaml` –∑–∞–¥–∞—ë—Ç –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞:
```yaml
steps:
  localize_categories: true
  localize_subcategories: true
  fill_views: true
  generate_affirmations: true
  script_affirmations: true
  music_prompts: true
  generate_audio: false

range:
  categories: [1, -1]
  subcategories: [1, -1]
  positions: [1, -1]

languages: [ru, en]
versions: [Roxie, Goddard]
voices: [1, 2, 3]
affirmations_per_subcategory: 10
threads: 4

audio_mix:
  music_volume_db: -3
  music_fade_in_ms: 2000
  music_fade_out_ms: 3000
```

---

## ‚öôÔ∏è –ó–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–∞

### –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö —à–∞–≥–æ–≤
```bash
python main.py
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —à–∞–≥–∞
```bash
python main.py --step=4
```

### Dry-run (–±–µ–∑ –∑–∞–ø–∏—Å–∏ –∏ –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤)
```bash
python main.py --dry-run
```

---

## üß† –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–∞–π–ø–ª–∞–π–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 7 —à–∞–≥–æ–≤:
0. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ ‚Äî [–æ–ø–∏—Å–∞–Ω–∏–µ —à–∞–≥–∞](steps/00_multithreading.md)
1. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Supabase.
2. **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π** ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ –ø–æ–ª—É –∏ —è–∑—ã–∫—É.
3. **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ views** ‚Äî –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω—ã—Ö –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤.
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π** ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞–±–æ—Ä–æ–≤ —Å—Ü–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞.
5. **–°—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π** ‚Äî –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π –Ω–∞ —Ü–µ–ª–µ–≤—ã–µ —è–∑—ã–∫–∏.
6. **–û–∑–≤—É—á–∫–∞** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è TTS —á–µ—Ä–µ–∑ ElevenLabs —Å —Ç–∞–π–º–∏–Ω–≥–∞–º–∏.
7. **–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –ø—Ä–æ–º—Ç—ã** ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–ø–∏—Å–∞–Ω–∏–π —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏.
8. **–°–≤–µ–¥–µ–Ω–∏–µ –º—É–∑—ã–∫–∏** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–æ–Ω–æ–≤–æ–π –¥–æ—Ä–æ–∂–∫–∏ –∏ –º–∏–∫—Å —Å –≥–æ–ª–æ—Å–æ–º.

---

## üóÇ –≠–∫—Å–ø–æ—Ä—Ç –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

–ö–∞—Ç–∞–ª–æ–≥ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ TTS:

```
/export/
‚îú‚îÄ‚îÄ audio/      # –≥–æ—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –æ–∑–≤—É—á–∫–∏
‚îî‚îÄ‚îÄ json/       # –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
```

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ö–µ–º–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –¥–ª—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ TTS:
```
<category_pos>_<subcategory_pos>_<position>_<m|w>_<lang>_ts<unix>.mp3
```

---

## üßæ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- –í –∫–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è: —Å—Ç–∞—Ä—Ç/—Ñ–∏–Ω–∏—à —à–∞–≥–∞ –∏ –∑–∞–¥–∞—á, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –ø—Ä–æ–≥—Ä–µ—Å—Å.
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥ `./logs/last_run.log` —Å–æ–¥–µ—Ä–∂–∏—Ç payload –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ ID, —Ä–µ—Ç—Ä–∞–∏, –æ—à–∏–±–∫–∏.
- –î–ª—è OpenAI/ElevenLabs –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–æ –¥–æ **3 –ø–æ–ø—ã—Ç–æ–∫** (—Å –ø–∞—É–∑–∞–º–∏ 5 / 10 —Å–µ–∫—É–Ω–¥).

---

## üìã –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Supabase

–¢–∞–±–ª–∏—Ü—ã –æ–ø–∏—Å–∞–Ω—ã –≤ [prd_content](prd_content.md)

---

## üß© –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ CLI

```bash
python main.py
```

---

## üß± –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ** (`venv`).
- –î–ª—è –Ω–æ–≤—ã—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ –∫–æ–¥ –≤ `config.yaml > languages`.
- –í—Å–µ —à–∞–≥–∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—é—Ç—Å—è –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤ `/docs/steps/*.md`.

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------------|
| `docs/prd_content.md` | Product Requirements Document |
| `docs/readme.md` | –í–≤–æ–¥–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è |
| `docs/steps/*.md` | –û–ø–∏—Å–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —à–∞–≥–æ–≤ |
| `docs/agents/*.md` | –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è ChatGPT |
