# –®–∞–≥ 1: –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π

## üéØ –¶–µ–ª—å
–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ —Ç–∞–±–ª–∏—Ü–µ `categories` –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏—è.  
–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ `localization` –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON:  
```json
{"ru": "‚Ä¶", "en": "‚Ä¶"}
```

> **Pydantic:** –¥–ª—è —ç—Ç–æ–≥–æ —à–∞–≥–∞ —Å–æ–∑–¥–∞—ë–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ Pydantic-—Å—Ö–µ–º—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –ù–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º –∏ –Ω–µ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –º–æ–¥–µ–ª–∏ –¥—Ä—É–≥–∏—Ö —à–∞–≥–æ–≤, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã.

---

## üß© –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –¢–∞–±–ª–∏—Ü–∞ Supabase: `categories`
- –ü–æ–ª—è:
  - `id`
  - `name` ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–¥–µ–Ω—å–≥–∏", "self love")
  - `localization` ‚Äî –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç—Ç–∏–º —à–∞–≥–æ–º
  - `position` ‚Äî –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–§–ª–∞–≥ –≤ `config.yaml`:
```yaml
steps:
  localize_categories: true
```
–ï—Å–ª–∏ —Ñ–ª–∞–≥ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `false`, —à–∞–≥ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.

---

## üöÄ –õ–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ `range.categories` (–∏–∑ `config.yaml`).
2. –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:
   - –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –∏–∑ `docs/agents/category.md`.
   - –ü–µ—Ä–µ–¥–∞—Ç—å –≤ ChatGPT:
     ```json
     {
       "category_name": "<–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è>"
     }
     ```
   - –£–∫–∞–∑–∞—Ç—å `response_format` –∫–∞–∫ dataclass —Å –ø–æ–ª—è–º–∏ `ru` –∏ `en`.
3. –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç ChatGPT –∏ –∑–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Supabase:
   ```json
   {"ru": "‚Ä¶", "en": "‚Ä¶"}
   ```
4. –ó–∞—Ç–µ—Ä–µ—Ç—å —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è `localization`.
5. –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥ –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## üí° –ü—Ä–∏–º–µ—Ä —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞ (`docs/agents/category.md`)
```markdown
–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ª–æ–∫–∞–ª–∏–∑–∞—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏—è–º.

–ó–∞–¥–∞—á–∞: –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –≤—Å–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏ (ru, en).
–°–æ—Ö—Ä–∞–Ω–∏ —Å–º—ã—Å–ª –æ—Ä–∏–≥–∏–Ω–∞–ª–∞, –Ω–æ –∞–¥–∞–ø—Ç–∏—Ä—É–π –ø–æ–¥ —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é.

–ü—Ä–∏–º–µ—Ä:
Input: "–¥–µ–Ω—å–≥–∏"
Output:
{
  "ru": "–î–µ–Ω—å–≥–∏",
  "en": "Money"
}
```

---

## üß† –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –∫ ChatGPT

```python
prompt = open("docs/agents/category.md").read()
response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[
        {"role": "system", "content": prompt},
        {"role": "user", "content": category["name"]}
    ],
    response_format={"type": "json_object"}
)
result = json.loads(response.choices[0].message["content"])
supabase.table("categories").update({"localization": result}).eq("id", category["id"]).execute()
```

---

## üì¶ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ –ø–æ–ª–µ `localization` –≤ Supabase –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- –õ–æ–≥ –≤ `./logs/last_run.log` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:
  - ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  - –Ω–∞–∑–≤–∞–Ω–∏–µ
  - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–∞
  - –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ –±—ã–ª–∏)

---

## üßæ –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏
| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|----------|----------|
| `Invalid JSON` | ChatGPT –≤–µ—Ä–Ω—É–ª –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π JSON | –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —Ä–µ—Ç—Ä–∞–∏ 3 –ø–æ–ø—ã—Ç–∫–∏) |
| `Supabase update failed` | –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `.env` |
| `Empty response` | ChatGPT –Ω–µ –≤–µ—Ä–Ω—É–ª –ø–µ—Ä–µ–≤–æ–¥ | –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å –≤—Ä—É—á–Ω—É—é |
| `KeyError: 'localization'` | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–ª–µ –≤ –æ—Ç–≤–µ—Ç–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —à–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞ |

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–º–µ—é—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –ø–æ–ª–µ `localization`.
- –û—à–∏–±–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏–ª–∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ –ª–æ–≥–∞—Ö.
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ.
