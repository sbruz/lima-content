# –®–∞–≥ 5: –°—Ü–µ–Ω–∞—Ä–∏–∏ –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π

## üéØ –¶–µ–ª—å
–ü–æ–ª—É—á–∏—Ç—å –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ä–∞–Ω–µ–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ñ—Ñ–∏—Ä–º–∞—Ü–∏–π, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ –ø–æ–ª—É –∏ —è–∑—ã–∫–∞–º –≤ —Ç–∞–±–ª–∏—Ü–µ `affirmations`.

---

## üß© –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –¢–∞–±–ª–∏—Ü–∞ `affirmations`: `subcategory_id`, `coach_id`, `position`, `affirmation`, `script`.
- –¢–∞–±–ª–∏—Ü–∞ `coaches`: `id`, `coach`, `prompt`.
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `config.yaml`:
  - `languages` ‚Äî —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö —è–∑—ã–∫–æ–≤ (ISO-–∫–æ–¥—ã –≤ –≤–µ—Ä—Ö–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ);
  - `versions` ‚Äî —Ç—Ä–µ–Ω–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º;
  - `steps.script_affirmations`.

> **Pydantic:** –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ö–µ–º—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞/–æ—Ç–≤–µ—Ç–∞. –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –∏–∑ –¥—Ä—É–≥–∏—Ö —à–∞–≥–æ–≤.

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```yaml
steps:
  script_affirmations: true

script_affirmations_add_pauses: true  # –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å—Å—è –ø–µ—Ä–µ–≤–æ–¥–æ–º

languages: [RU, EN, ES]
versions: [Roxie, Goddard]
```

---

## üöÄ –õ–æ–≥–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
1. –°—á–∏—Ç–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç—Ä–µ–Ω–µ—Ä–æ–≤ –∏–∑ `coaches`, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ `config.versions`.
2. –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Ç—Ä–µ–Ω–µ—Ä–∞ –∏ **–æ—Ç–¥–µ–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏** (job = —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ç—Ä–æ–π–∫–∞ `subcategory_id + coach + position`):
   1. –ü–æ–ª—É—á–∏—Ç—å –∑–∞–ø–∏—Å—å `affirmations` –ø–æ —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏.
   2. –ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.
3. –í–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞ –ø–æ —è–∑—ã–∫–∞–º –≤—ã–ø–æ–ª–Ω—è–µ–º **–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–¥–∑–∞–¥–∞—á–∏**:
   1. **–ü–µ—Ä–µ–≤–æ–¥ (TRNS).** –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–º–ø—Ç `docs/agents/affirmations_script_translate.md`.  
      - –í—Ö–æ–¥:
        ```json
        {
          "category": "...",
          "subcategory": "...",
          "coach": "...",
          "coach_prompt": "...",
          "target_language": "RU",
          "affirmation": {
            "female": {"title": "...", "script": "..."},
            "male":   {"title": "...", "script": "..."}
          }
        }
        ```
      - –í—ã—Ö–æ–¥ ‚Äî —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç (`AffirmationResponseModel`).  
      - –î–ª—è –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º: –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã.
   2. **–†–∞—Å—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—É–∑ (PAUS).** –ü—Ä–æ–º–ø—Ç `docs/agents/affirmations_script_pauses.md`. –ü–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ LLM –∏–∑ `script` —É–¥–∞–ª—è–µ–º –≤—Å–µ `\n`/`\n\n` (–∑–∞–º–µ–Ω—è–µ–º –Ω–∞ –ø—Ä–æ–±–µ–ª—ã). –®–∞–≥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ `config.yaml` `script_affirmations_add_pauses = true`. –ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç —Å —Ä–∞—Å—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ `\n`.
   3. –ö–∞–∂–¥–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —à–∞–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –≤–∏–¥–∞  
      `[PROG] ctx=SUB:Coach | lang=RU | stage=TRNS [####------] 40.0% ETA=00:12 JTBD=TRNS`.  
      –ü–æ–ª–æ—Å–∞ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è ETA, –∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —è–∑—ã–∫–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞.
   4. –ü–æ—Å–ª–µ —à–∞–≥–∞ PAUS (–∏–ª–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞, –µ—Å–ª–∏ –ø–∞—É–∑—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã) –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–±—â–∏–π —Å–ª–æ–≤–∞—Ä—å `{"female": {lang: {...}}, "male": {lang: {...}}}`.
   5. –ü–µ—Ä–µ–¥ –∑–∞–ø–∏—Å—å—é –≤ `affirmations.script` –∑–∞–º–µ–Ω—è–µ–º –≤ –∫–∞–∂–¥–æ–º `script` –≤—Å–µ –∫–∞–≤—ã—á–∫–∏ –Ω–∞ –∞–ø–æ—Å—Ç—Ä–æ—Ñ—ã –∏ —É–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ —ç–∫—Ä–∞–Ω–∏—Ä—É—é—â–∏–µ —Å–ª–µ—à–∏, —á—Ç–æ–±—ã JSON –æ—Å—Ç–∞–≤–∞–ª—Å—è —á–∏—Å—Ç—ã–º.
   6. –ü–æ—Å–ª–µ –æ–±—Ö–æ–¥–∞ –≤—Å–µ—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ —è–∑—ã–∫–∏, –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ–º JSON –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ `affirmations.script`.
   5. –ü–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π –æ–±–Ω—É–ª—è–µ–º –ø–æ–ª–µ `script`, –∑–∞—Ç–µ–º –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏.
3. –í—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ LLM –æ–±–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è –≤ —Ä–µ—Ç—Ä–∞–∏ (—Å–º. –Ω–∞—Å—Ç—Ä–æ–π–∫—É `retry`) –∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ —è–∑—ã–∫–∞–º.

---

## üì¶ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –¢–∞–±–ª–∏—Ü–∞ `affirmations` –æ–±–Ω–æ–≤–ª–µ–Ω–∞: –∫–∞–∂–¥–æ–µ –ø–æ–ª–µ `script` –∑–∞–ø–æ–ª–Ω–µ–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —Å —è–∑—ã–∫–∞–º–∏ –¥–ª—è –∂–µ–Ω—â–∏–Ω –∏ –º—É–∂—á–∏–Ω.
- –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç:
  - –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è: —Å—Ç–∞—Ä—Ç/—Ñ–∏–Ω–∏—à –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ √ó —Ç—Ä–µ–Ω–µ—Ä, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å;
  - –≤–∏–∑—É–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ (TRNS/PAUS —Å ETA –∏ JTBD);
  - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–ø–∏—Å–∏ –æ –∑–∞–ø—Ä–æ—Å–∞—Ö –≤ `logs/last_run.log`.

---

## üßæ –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏
| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –î–µ–π—Å—Ç–≤–∏—è |
|--------|---------|----------|
| `FatalStepError` –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö | –ø—Ä–æ–±–ª–µ–º—ã —Å Supabase | –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |
| `RetryableStepError` –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ `script` | —Å–µ—Ç–µ–≤–æ–π —Å–±–æ–π –∏–ª–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç | –ø–∞–π–ø–ª–∞–π–Ω –ø–æ–≤—Ç–æ—Ä–∏—Ç –ø–æ–ø—ã—Ç–∫—É |
| –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Pydantic | LLM –≤–µ—Ä–Ω—É–ª –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç | –æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç / —Å—Ö–µ–º—É |

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ `affirmations` –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª–µ `script`.
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —è–∑—ã–∫–∏ –∏–∑ `config.languages`.
- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∫–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è √ó —Ç—Ä–µ–Ω–µ—Ä.
